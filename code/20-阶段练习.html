<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        table {
            border-collapse: collapse;
        }

        td,
        th {
            border: 1px solid black;
            padding: 10px 30px;
        }

        [v-cloak] {
            display: none;
        }
    </style>
    <script src="./js/vue.js"></script>
</head>

<body>
    <div id="app" v-cloak>
        <div>
            <label for="name">用户名称：</label>
            <input type="text" id="name" v-model="user.name">
        </div>
        <div>
            <label for="age">用户年龄：</label>
            <input type="number" id="age" v-model.number="user.age">
        </div>
        <div>
            <label for="sex">用户性别：</label>
            男：<input type="radio" id="sex" value="男" v-model="user.sex">
            女：<input type="radio" id="sex" value="女" v-model="user.sex">
            秘密：<input type="radio" id="sex" value="未知" v-model="user.sex">
        </div>
        <div>
            <label for="skill">用户技能：</label>
            <select id="skill" v-model="user.skill">
                <option value="">请选择</option>
                <option value="java">java</option>
                <option value="html">html</option>
                <option value="javascript">javascript</option>
                <option value="vue">vue</option>
            </select>
        </div>
        <input type="button" value="添加新用户" @click="addUser()">
        <hr>
        <table>
            <thead>
                <tr>
                    <td>
                        <input type="checkbox" v-model="all" @change="changeAllSel()">
                    </td>
                    <td>编号</td>
                    <td>姓名</td>
                    <td>年龄</td>
                    <td>出生年份</td>
                    <td>性别</td>
                    <td>技能</td>
                    <td>操作</td>
                </tr>
            </thead>
            <tbody>
                <tr v-show="userList.length==0">
                    <th colspan="7">暂无数据</th>
                </tr>
                <tr v-show="userList.length!=0" v-for="(user, i) in userList">
                    <td>
                        <input type="checkbox" :value="user.id" v-model="selectUser" @change="checkAllSelect()">
                    </td>
                    <td>{{ i+1 }}</td>
                    <td>{{ user.name }}</td>
                    <td>{{ user.age }}</td>
                    <td>出生年份</td>
                    <td>{{ user.sex }}</td>
                    <td>{{ user.skill }}</td>
                    <td>  
                        <input type="button" value="删除" @click="removeUser(i)">
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</body>
<script>
    new Vue({
        el: "#app",
        data: {
            // name:"",
            // age:0,
            // sex:"",
            // skill:"",
            user: {
                name: "",
                age: 0,
                sex: "",
                skill: "",
            },
            userList: [
                {name:"aaa",age:23,sex:"男",skill:"html",id:45678},
                {name:"bbb",age:23,sex:"男",skill:"vue",id:34567},
                {name:"ccc",age:21,sex:"女",skill:"javascript",id:23456},
                {name:"ddd",age:27,sex:"未知",skill:"java",id:12345}
            ],
            selectUser:[],
            all:false
        },
        methods: {
            addUser() {
                // let user = {
                //     name: this.name,
                //     age: this.age,
                //     sex: this.sex,
                //     skill: this.skill
                // }
                // this.userList.push(user);

                // 对象的浅克隆和深克隆
                // ES6 对象展开符 ...
                this.userList.push( { 
                    ...this.user,
                    id:Math.random() 
                } );
                this.all = false;
            },
            removeUser(i){
                this.userList.splice(i,1);
                this.checkAllSelect();
            },
            checkAllSelect(){
                // if(this.userList.length==this.selectUser.length){
                //     this.all = true;
                // }else{
                //     this.all = false;
                // }
                console.log("checkAllSelect")
                this.all = this.userList.length==this.selectUser.length;
            },
            changeAllSel(){
                if(this.all){
                    // 全选
                    for (let i = 0; i < this.userList.length; i++) {
                       this.selectUser.push( this.userList[i].id);
                    }
                }else{
                    // 全不选
                    this.selectUser = [];
                }
            }
        },
    })

</script>

</html>